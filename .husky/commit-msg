#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Get the commit message (first argument is the file containing the message)
commit_msg=$(cat "$1")

# Define the conventional commit pattern
# Format: type(scope): description
# Example: feat(auth): add login functionality
conventional_commit_regex='^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .{1,}$'

# Check if commit message follows the pattern
if ! echo "$commit_msg" | grep -qE "$conventional_commit_regex"; then
    echo ""
    echo "üö´ Invalid commit message format!"
    echo ""
    echo "üìã Your commit message must follow the Conventional Commits standard:"
    echo ""
    echo "   type(scope): description"
    echo ""
    echo "üìå Types allowed:"
    echo "   ‚Ä¢ feat     - New feature"
    echo "   ‚Ä¢ fix      - Bug fix"
    echo "   ‚Ä¢ docs     - Documentation changes"
    echo "   ‚Ä¢ style    - Code style changes (formatting, etc.)"
    echo "   ‚Ä¢ refactor - Code refactoring"
    echo "   ‚Ä¢ perf     - Performance improvements"
    echo "   ‚Ä¢ test     - Adding or updating tests"
    echo "   ‚Ä¢ build    - Build system changes"
    echo "   ‚Ä¢ ci       - CI/CD changes"
    echo "   ‚Ä¢ chore    - Other changes (dependencies, etc.)"
    echo "   ‚Ä¢ revert   - Revert a previous commit"
    echo ""
    echo "‚úÖ Examples:"
    echo "   feat(auth): add login functionality"
    echo "   fix(api): resolve null pointer exception"
    echo "   docs(readme): update installation steps"
    echo "   test: add unit tests for user service"
    echo ""
    echo "‚ùå Your message: $commit_msg"
    echo ""
    exit 1
fi

echo "‚úÖ Commit message follows Conventional Commits standard!"
